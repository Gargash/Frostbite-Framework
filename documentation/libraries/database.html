<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>Database Class :: Frostbite Framework Documentation</title>

	<style type='text/css' media='all'>@import url('./userguide.css');</style>
	<link rel='stylesheet' type='text/css' media='all' href='../doc_style/userguide.css' />
</head>
<body>

<!-- START NAVIGATION -->
<div id="nav"><div id="nav_inner"></div></div>
<div id="nav2"><a name="top">&nbsp;</a></div>
<div id="masthead">
	<table cellpadding="0" cellspacing="0" border="0" style="width:100%">
		<tr>
			<td><h1>Frostbite Framework</h1></td>
			<td id="breadcrumb_right"><a href="../index.html">Return To Index</a></td>
		</tr>
	</table>
</div>
<!-- END NAVIGATION -->

<br clear="all" />

<!-- START CONTENT -->
<div id="content">
	<h1>Database Class</h1>

	<p>
		The Database is there to make querying the database much easier. It comes with a QueryBuilder which makes queries extremely easy.
	</p>
	
	<p>Features:</p>
	<ul>
		<li>Comes with a QueryBuilder, which can be used to dynamically build MySQL qeuries</li>
		<li>Prepared returned arrays</li>
		<li>Automatic Sql Injection cleaning (When using QueryBuilder)</li>
		<li>Chain querying functions (When using QueryBuilder)</li>
	</ul>

	
	<!-- Connection -->
	<h2>Using the loader to establish a Database Connection</h2>
	<p>
		Before you establish a database connection, you need to enter the connection info in the "Application/config/database.config.php" file.
		Below is an example of how to configure you DB connection:
	</p>
	<pre>
		$DB_configs = array( 
			'<var>$config_key</var>' => array(
				'hostname' => 'host IP';
				'port' => 'mysql port #';
				'username' => 'database username';
				'password' => 'database password';
				'database' => 'name of the database';
			),
			'<var>$config_key2</var>' => array(
				'hostname' => .....
		);
	</pre>
	
	<p>Now below, this how we load that very connection:
	<code>
		$connection = $this->load->database('<var>$config_key</var>', '<dfn>$instance</dfn>');
	</code>
	
	<p>
		<dfn>$instance</dfn>: Default = <font color="blue"><b>FALSE</b></font> - Do we instance this connection in the controller super object? 
	</p>
	
	<p class="important">
		<kbd>NOTE:</kbd> If <dfn>$instance</dfn>
		is set to <font color='blue'><b>TRUE</b></font>, then <var>$connection = </var> is <b>NOT</b> needed as it will be instanced as "$this->$config_key" UNLESS you are using it outside the
		controller.
	</p>
	
	
	
	<!-- Manual -->
	<h2>Manually Querying the Database (No QueryBuilder)</h2>
	<p>
		It is possible to query the database without using the querybuilder. Although this is highly un-recomended, it is possible for those who wish to not use the querybuilder.
		The example below shows how you would manually query the Database, and then retrieve the result.
	</p>
	
	Instanced:
	<code>
		$this-><var>$database_key</var>->query('<var>$query</var>');<br />
		$result = $this-><var>$database_key</var>->result();
	</code>
	
	Not - Instanced:
	<code>
		$connection-><var>$database_key</var>->query('<var>$query</var>');<br />
		$result = $connection-><var>$database_key</var>->result();
	</code>
	
	<p>
		<var>$database_key</var>: The same as the <var>$config_key</var> in the Connection example.<br />
		<var>$query</var>: The query you are putting the in the Database.
	</p>
	
	
	
	<!-- Query Builder -->
	<h2>Using the QueryBuilder (Examples)</h2>
	<p>
		The QueryBuilder makes it easy to piece together your queries, and the best part is it automatically cleans your inputs so you dont have to worry about Sql Injection.
		In the example below, i will show you how to use the query builder to build your statments:
	</p>
	
	<!-- Select -->
	<h3>A Simple SELECT Statement</h3>
	<code>
		$this-><var>$database_key</var>->select('<var>$columns</var>')->from('<var>$table</var>')->where('<var>$col</var>', '<var>$value</var>')->query();<br />
		$result = $this-><var>$database_key</var>->result();
	</code>
	<p>
		<var>$database_key</var>: The same as the <var>$config_key</var> in the Connection example.<br />
		<var>$columns</var>: This can be formated in either an array, or a string. <b>If Array</b>: array('col1', 'col2', 'col3'); <b>Or String</b>: 'col1, col2, col3'. You can also use an " * " 
			to select all columns.<br />
		<var>$table</var>: The name of the table we are quering.<br />
		<var>$col</var>: The column in the where, that we are selecting.<br />
		<var>$value</var>: The value of the <var>$col</var> in the Where statement.<br />
	</p>
	
	<!-- insert -->
	<h3>A Simple INSERT Statement</h3>
	<code>
		$this-><var>$database_key</var>->insert('<var>$table</var>', '<var>$array</var>')->query();<br />
		$result = $this-><var>$database_key</var>->result();
	</code>
	<p>
		<var>$database_key</var>: The same as the <var>$config_key</var> in the Connection example.<br />
		<var>$table</var>: The name of the table we are quering.<br />
		<var>$array</var>: This is an array of "$column_name => $value". Example: $array = array('col1' => 'value1', 'col2' => 'value2', 'col3' => 'value3');<br />
	</p>
	
	<!-- update -->
	<h3>A Simple UPDATE Statement</h3>
	<code>
		$this-><var>$database_key</var>->update('<var>$table</var>', '<var>$array</var>')->where('<var>$col</var>', '<var>$value</var>')->query();<br />
		$result = $this-><var>$database_key</var>->result();
	</code>
	<p>
		<var>$database_key</var>: The same as the <var>$config_key</var> in the Connection example.<br />
		<var>$table</var>: The name of the table we are quering.<br />
		<var>$array</var>: This is an array of "$column_name => $value". Example: $array = array('col1' => 'value1', 'col2' => 'value2', 'col3' => 'value3');<br />
		<var>$col</var>: The column in the where, that we are selecting.<br />
		<var>$value</var>: The value of the <var>$col</var> in the Where statement.<br />
	</p>
	
	<!-- Delete -->
	<h3>A Simple DELETE Statement</h3>
	<code>
		$this-><var>$database_key</var>->delete_from('<var>$table</var>')->where('<var>$col</var>', '<var>$value</var>')->query();<br />
		$result = $this-><var>$database_key</var>->result();
	</code>
	<p>
		<var>$database_key</var>: The same as the <var>$config_key</var> in the Connection example.<br />
		<var>$table</var>: The name of the table we are quering.<br />
		<var>$col</var>: The column in the where, that we are selecting.<br />
		<var>$value</var>: The value of the <var>$col</var> in the Where statement.<br />
	</p>
	
	
	
	<!-- Query Builder Functions -->
	<h2>QueryBuilder Methods</h2>
	<p>
		This is a giant list of methods that are in the querybuilder for referencing.
	</p>
	
	<!-- Query -->
	<h3>query()</h3>
	<p>A manually query method. <var>$query</var> is the query to be run into the DB.</p>
	<code>$this->database->query('<var>$query</var>');</code>
	
	<!-- Select -->
	<h3>select()</h3>
	<p>Used to select columns in a table. <var>$columns</var> is either an array of columns, or a string with columns seperated with a comma. Can also use a "*" to select all columns.</p>
	<code>$this->database->select('<var>$columns</var>');</code>
	
	<!-- Select Min -->
	<h3>select_min()</h3>
	<p>Used to select a minimum result from a column. <var>$col</var> is the column we are selecting the MIN from.</p>
	<code>$this->database->select_min('<var>$col</var>');</code>
	
	<!-- Select MAX -->
	<h3>select_max()</h3>
	<p>Used to select a max result from a column. <var>$col</var> is the column we are selecting the MAX from.</p>
	<code>$this->database->select_max('<var>$col</var>');</code>
	
	<!-- Select AVG -->
	<h3>select_avg()</h3>
	<p>Used to select a average result from a column. <var>$col</var> is the column we are selecting the AVG from.</p>
	<code>$this->database->select_avg('<var>$col</var>');</code>
	
	<!-- Select SUM -->
	<h3>select_sum()</h3>
	<p>Used to select the sum of results from a column. <var>$col</var> is the column we are selecting the SUM from.</p>
	<code>$this->database->select_sum('<var>$col</var>');</code>
	
	<!-- Select Count -->
	<h3>select_count()</h3>
	<p>Used to select a count of results from a column. <var>$col</var> is the column we are selecting the COUNT from.</p>
	<code>$this->database->select_count('<var>$col</var>');</code>
	
	<!-- Insert -->
	<h3>insert()</h3>
	<p>Used to insert information into the Database. <var>$table</var> is the table we are inserting to, and <var>$data</var> is an array of " $column => $value".</p>
	<code>$this->database->insert('<var>$table</var>', '<var>$data</var>');</code>
	
	<!-- Update -->
	<h3>update()</h3>
	<p>Used to update information into the Database. <var>$table</var> is the table we are updating, and <var>$data</var> is an array of " $column => $value".</p>
	<code>$this->database->update('<var>$table</var>', '<var>$data</var>');</code>
	
	<!-- Delete -->
	<h3>delete_from()</h3>
	<p>Used to delete a row from a table. <var>$table</var> is the table we are deleting from.</p>
	<code>$this->database->delete_from('<var>$table</var>');</code>
	
	<!-- Result -->
	<h3>result()</h3>
	<p>Used to retrive the result of the last SQL query.</p>
	<code>$result = $this->database->result();</code>
	
	<!-- Fetch -->
	<h3>fetch()</h3>
	<p>A manually query method which can be used in SELECT methods. <var>$query</var> is the query to be run into the DB.</p>
	<code>$this->database->fetch('<var>$query</var>');</code>
	
	<!-- Clear Query -->
	<h3>clear_query()</h3>
	<p>Using this method will clear out the last query. Not really needed.</p>
	<code>$this->database->clear_query();</code>
	
	<!-- Count Results -->
	<h3>count_results()</h3>
	<p>Counts the number of results in the result of the last query.</p>
	<code>$this->database->count_results();</code>
	
	<!-- Insert Id -->
	<h3>get_insert_id()</h3>
	<p>Use just like mysql_insert_id(). Gets the id from the last INSERT method</p>
	<code>$this->database->get_insert_id();</code>
	
	<!-- Affectde Rows -->
	<h3>affected_rows()</h3>
	<p>Use just like mysql_affected_rows(). Returns the number of rows affected by the last query.</p>
	<code>$this->database->affected_rows();</code>
	
	<!-- Number of rows -->
	<h3>num_rows()</h3>
	<p>Use just like mysql_num_rows()</p>
	<code>$this->database->num_rows();</code>
	
	<!-- Where -->
	<h3>where()</h3>
	<p>adds a "WHERE $col = $val" to the query. <var>$col</var> is the column we are selecting, and <var>$val</var> is the value of that column.</p>
	<code>$this->database->where('<var>$col</var>', '<var>$val</var>');</code>
	
	<!-- And Where -->
	<h3>and_where()</h3>
	<p>adds a "AND $col = $val" to the query. <var>$col</var> is the column we are selecting, and <var>$val</var> is the value of that column.</p>
	<code>$this->database->and_where('<var>$col</var>', '<var>$val</var>');</code>
	
	<!-- Or Where -->
	<h3>or_where()</h3>
	<p>adds a "OR $col = $val" to the query. <var>$col</var> is the column we are selecting, and <var>$val</var> is the value of that column.</p>
	<code>$this->database->or_where('<var>$col</var>', '<var>$val</var>');</code>
	
	<!-- From -->
	<h3>from()</h3>
	<p>adds a "FROM $table" to the query. <var>$table</var> is the table we are selecting.</p>
	<code>$this->database->from('<var>$table</var>');</code>
	
	<!-- Like -->
	<h3>where_like()</h3>
	<p>adds a "WHERE $col LIKE $val" to the query. <var>$col</var> is the column we are selecting we are selecting, and $val is what we are comparing to.</p>
	<code>$this->database->where_like('<var>$col</var>', '<var>$val</var>');</code>
	
	<!-- Not ike -->
	<h3>where_not_like()</h3>
	<p>adds a "WHERE $col NOT LIKE $val" to the query. <var>$col</var> is the column we are selecting we are selecting, and $val is what we are comparing to.</p>
	<code>$this->database->where_not_like('<var>$col</var>', '<var>$val</var>');</code>
	
	<!-- And Like -->
	<h3>and_like()</h3>
	<p>adds a "AND $col LIKE $val" to the query. <var>$col</var> is the column we are selecting we are selecting, and $val is what we are comparing to.</p>
	<code>$this->database->and_like('<var>$col</var>', '<var>$val</var>');</code>
	
	<!-- And Not Like -->
	<h3>and_not_like()</h3>
	<p>adds a "AND $col NOT LIKE $val" to the query. <var>$col</var> is the column we are selecting we are selecting, and $val is what we are comparing to.</p>
	<code>$this->database->and_not_like('<var>$col</var>', '<var>$val</var>');</code>
	
	<!-- Group By-->
	<h3>groupBy()</h3>
	<p>Groups it by $col. <var>$col</var> is the coulumn we are grouping by.</p>
	<code>$this->database->groupBy('<var>$col</var>');</code>
	
	<!-- Order By-->
	<h3>orderBy()</h3>
	<p>adds "ORDER BY $col $type" to the query. <var>$col</var> is what column we are ordering by, and <var>$type</var> is how we are ording such as ASC or DESC.</p>
	<code>$this->database->orderBy('<var>$col</var>', '<var>$type</var>');</code>
	
	<!-- Having -->
	<h3>having()</h3>
	<p>adds "HAVING $what" to the query. <var>$what</var> is what the column must have to be returned.</p>
	<code>$this->database->having('<var>$what</var>');</code>
	
	<!-- LIMIT -->
	<h3>limit()</h3>
	<p>adds "LIMIT $x, $y" to the query. <var>$x</var> is the number if records to display, and $y is our starting point if we are not starting on record number 1.</p>
	<code>$this->database->limit('<var>$x</var>', '<dfn>$y</dfn>');</code>


</div>
<!-- END CONTENT -->


<div id="footer">
	<p>
		Previous Topic:&nbsp;&nbsp;<a href="config.html">Config Class</a> &nbsp;&nbsp;&nbsp;&middot;&nbsp;&nbsp;
		<a href="#top">Top of Page</a> &nbsp;&nbsp;&nbsp;&middot;&nbsp;&nbsp;
		<a href="../index.html">Return to Index</a> &nbsp;&nbsp;&nbsp;&middot;&nbsp;&nbsp;
		Next Topic:&nbsp;&nbsp;<a href="loader.html">Loader Class</a>
	</p>
	<p>Original Template Copyright &#169; 2006 - 2011 &nbsp;&middot;&nbsp; <a href="http://ellislab.com/">EllisLab, Inc.</a></p>
</div>

</body>
</html>